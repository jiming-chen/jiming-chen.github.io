<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OCaml Transformer | Jiming Chen</title>
<meta name=keywords content><meta name=description content="This (Cornell GitHub) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.

      
    

Fig. 1. YouTube demo of our post generator made by Haadi.
Probabilistic Model
Before creating the transformer, we first created a probabilistic model."><meta name=author content="Jiming Chen"><link rel=canonical href=http://localhost:1313/projects/transformer/><link crossorigin=anonymous href=/assets/css/stylesheet.862d2ab5d22734725b747026f6cbcd72cf56acbcb80e88f95d22ca71d767e619.css integrity="sha256-hi0qtdInNHJbdHAm9svNcs9WrLy4Doj5XSLKcddn5hk=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/icons/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/icons/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/%3C/icons/apple-touch-icon.png%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/projects/transformer/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-KTD621L9T6"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-KTD621L9T6")</script><meta property="og:url" content="http://localhost:1313/projects/transformer/"><meta property="og:site_name" content="Jiming Chen"><meta property="og:title" content="OCaml Transformer"><meta property="og:description" content="This (Cornell GitHub) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.
Fig. 1. YouTube demo of our post generator made by Haadi. Probabilistic Model Before creating the transformer, we first created a probabilistic model."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="projects"><meta property="article:published_time" content="2025-01-02T00:19:49-08:00"><meta property="article:modified_time" content="2025-01-02T00:19:49-08:00"><meta property="og:image" content="http://localhost:1313/projects/transformer/interface.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/projects/transformer/interface.png"><meta name=twitter:title content="OCaml Transformer"><meta name=twitter:description content="This (Cornell GitHub) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.

      
    

Fig. 1. YouTube demo of our post generator made by Haadi.
Probabilistic Model
Before creating the transformer, we first created a probabilistic model."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"http://localhost:1313/projects/"},{"@type":"ListItem","position":2,"name":"OCaml Transformer","item":"http://localhost:1313/projects/transformer/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OCaml Transformer","name":"OCaml Transformer","description":"This (Cornell GitHub) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.\nFig. 1. YouTube demo of our post generator made by Haadi. Probabilistic Model Before creating the transformer, we first created a probabilistic model.\n","keywords":[],"articleBody":"This (Cornell GitHub) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.\nFig. 1. YouTube demo of our post generator made by Haadi. Probabilistic Model Before creating the transformer, we first created a probabilistic model.\nFig. 2. Examples of posts from SideChat mobile app. These were retrieved by finding a hidden API using a MITM proxy. The probabilistic model simply kept track of the most likely words to follow any single word, determined by frequency and number of upvotes. To run the model, we started with a beginning word and let it generate a number of words, stopping at a set word count or if an token was produced. We also used temperature, so running the model twice produced different results.\nWith the probabilistic model, words made sense in shorter contexts but not in larger contexts, resulting in incoherent outputs. Here was a coherent output we got:\nCan we all agree with my mom\nTransformer Next, we implemented the transformer. We followed a basic architecture, implementing a tokenizer, matrix operations, etc. That being said, our we did not use GPUs, so our model size was very limited, and we were not able to decrease loss by that much. However, the outputs were certainly more interesting:\nlevel football eight-year-old ðŸ¤¤ opinion revert certainly humanities/social WILLING fist ILR,\nWe only needed 1,600 lines of code for this project, and we also had a time constraint, but in the future, we could use tensor computations from Jane Streetâ€™s ocaml-torch and improve the overall engineering.\n","wordCount":"290","inLanguage":"en","image":"http://localhost:1313/projects/transformer/interface.png","datePublished":"2025-01-02T00:19:49-08:00","dateModified":"2025-01-02T00:19:49-08:00","author":{"@type":"Person","name":"Jiming Chen"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/projects/transformer/"},"publisher":{"@type":"Organization","name":"Jiming Chen","logo":{"@type":"ImageObject","url":"http://localhost:1313/icons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/icons/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/about title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/projects/ title=Portfolio><span>Portfolio</span></a></li><li><a href=http://localhost:1313/posts/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/courses/ title="Course Notes"><span>Course Notes</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">OCaml Transformer</h1></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#probabilistic-model>Probabilistic Model</a></li><li><a href=#transformer>Transformer</a></li></ul></nav></div></details></div><div class=post-content><p>This (<a href=https://github.coecis.cornell.edu/hmk68/3110-final-project rel=noopener target=_blank>Cornell GitHub</a>) was our final project for CS 3110: Data Structures and Functional Programming. We implemented a simple transformer in OCaml and trained it on successful posts on SideChat, a social media app popular at Cornell and other schools. I worked with Haadi Khan, Domenic Fioravanti, and Will Bradley.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/qpr12wxoHbg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><figcaption>Fig. 1. YouTube demo of our post generator made by Haadi.</figcaption><h2 id=probabilistic-model>Probabilistic Model<a hidden class=anchor aria-hidden=true href=#probabilistic-model>#</a></h2><p>Before creating the transformer, we first created a probabilistic model.</p><img src=/projects/transformer/posts.png alt=GUI width=80% class=center><figcaption>Fig. 2. Examples of posts from SideChat mobile app. These were retrieved by finding a hidden API using a MITM proxy.</figcaption><p>The probabilistic model simply kept track of the most likely words to follow any single word, determined by frequency and number of upvotes. To run the model, we started with a beginning word and let it generate a number of words, stopping at a set word count or if an <code>&lt;END></code> token was produced. We also used temperature, so running the model twice produced different results.</p><p>With the probabilistic model, words made sense in shorter contexts but not in larger contexts, resulting in incoherent outputs. Here was a coherent output we got:</p><blockquote><p>Can we all agree with my mom</p></blockquote><h2 id=transformer>Transformer<a hidden class=anchor aria-hidden=true href=#transformer>#</a></h2><p>Next, we implemented the transformer. We followed a basic architecture, implementing a tokenizer, matrix operations, etc. That being said, our we did not use GPUs, so our model size was very limited, and we were not able to decrease loss by that much. However, the outputs were certainly more interesting:</p><blockquote><p>level football eight-year-old &#x1f924; opinion revert certainly humanities/social WILLING fist ILR,</p></blockquote><p>We only needed 1,600 lines of code for this project, and we also had a time constraint, but in the future, we could use tensor computations from Jane Street&rsquo;s <code>ocaml-torch</code> and improve the overall engineering.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Jiming Chen</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>